name: Update Dependencies

on:
 schedule:
    - cron: '0 0 * * 0' 

jobs:
 update:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Setup Node.js
      uses: actions/setup-node@v2
      with:
        node-version: '20.11.1' 

    - name: Install dependencies
      run: npm ci 

    - name: Check for updates
      run: |
        npm outdated --json > outdated.json
        if [ -s outdated.json ]; then
          echo "Updates found"
          echo "::set-output name=updates_found::true"
        else
          echo "No updates found"
          echo "::set-output name=updates_found::false"
        fi
      id: check

    - name: Create Pull Request
      if: steps.check.outputs.updates_found == 'true'
      uses: peter-evans/create-pull-request@v3
      with:
        title: "Update dependencies"
        body: "This PR updates the dependencies to their latest versions."
        branch: "update-dependencies"
        delete-branch: true
        commit-message: "Update dependencies"
        labels: "dependencies"
